#!/usr/bin/env python
import socket, threading, argparse, time, sys, os, random
from concurrent.futures import ThreadPoolExecutor

open_ports=[]
lock=threading.Lock()

# ---------- VISUALS ----------

def matrix():
    chars="01â–ˆâ–“â–’â–‘"
    for _ in range(20):
        line="".join(random.choice(chars) for _ in range(70))
        print("\033[32m"+line+"\033[0m")
        time.sleep(0.02)
    os.system("clear")

def slow(text,s=0.002):
    for c in text:
        sys.stdout.write(c)
        sys.stdout.flush()
        time.sleep(s)
    print()

def banner():
    matrix()
    slow("\033[36m")
    slow(" â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—")
    slow("â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘")
    slow("â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘")
    slow("â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—  â•šâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘")
    slow("â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘")
    slow("\033[0m")
    slow("\033[90mcrym nightmare â€” cryptokiddo's scanner | developed by suyog jung karki\033[0m\n")

def radar():
    spin="â—â—“â—‘â—’"
    for _ in range(20):
        for c in spin:
            sys.stdout.write(f"\rradar sweep {c}")
            sys.stdout.flush()
            time.sleep(0.05)
    print()

# ---------- SCANNING ----------

def grab(target,port):
    try:
        s=socket.socket()
        s.settimeout(1)
        s.connect((target,port))
        s.send(b"HEAD / HTTP/1.0\r\n\r\n")
        data=s.recv(1024).decode(errors="ignore")
        s.close()
        return data.split("\n")[0][:40]
    except:
        return ""

def alert(port):
    print(f"\033[31m[ALERT]\033[0m port {port} OPEN")

def scan(target,port):
    global open_ports
    try:
        s=socket.socket()
        s.settimeout(1)
        r=s.connect_ex((target,port))
        if r==0:
            b=grab(target,port)
            with lock:
                open_ports.append((port,b))
            alert(port)
        s.close()
    except: pass

def udp_scan(target,port):
    try:
        s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)
        s.settimeout(1)
        s.sendto(b'',(target,port))
        s.recvfrom(1024)
        print(f"\033[35m[UDP]\033[0m port {port} open|filtered")
    except: pass

# ---------- OS + EXPLOIT HINTS ----------

def os_guess(ports):
    p=[x[0] for x in ports]
    if 445 in p or 3389 in p:
        return "Windows target likely"
    if 22 in p and 80 in p:
        return "Linux/Unix target likely"
    return "Unknown OS"

def exploit_hint(ports):
    hints=[]
    for p,_ in ports:
        if p==21: hints.append("FTP â†’ try anonymous login")
        if p==22: hints.append("SSH â†’ brute or key reuse")
        if p==80: hints.append("HTTP â†’ dir brute / web vulns")
        if p==445: hints.append("SMB â†’ enum shares")
        if p==3306: hints.append("MySQL â†’ weak creds")
    return hints

# ---------- MAIN ----------

def main():
    parser=argparse.ArgumentParser()
    parser.add_argument("target")
    parser.add_argument("--fast",action="store_true")
    parser.add_argument("--udp",action="store_true")
    args=parser.parse_args()

    banner()
    radar()

    ports=range(1,1025) if args.fast else [21,22,23,25,53,80,110,139,143,443,445,3306,3389,8080]

    print(f"\n\033[33mscanning {args.target}...\033[0m\n")

    ex=ThreadPoolExecutor(max_workers=150)
    for p in ports:
        ex.submit(scan,args.target,p)
        if args.udp:
            ex.submit(udp_scan,args.target,p)
    ex.shutdown(wait=True)

    print("\n\033[32mopen ports summary:\033[0m")
    for p,b in sorted(open_ports):
        print(f"{p}/tcp  OPEN  {b}")

    print("\n\033[36mOS guess:\033[0m",os_guess(open_ports))

    print("\n\033[31mexploit hints:\033[0m")
    for h in exploit_hint(open_ports):
        print("-",h)

    print("\n\033[36mnightmare scan complete â€” crym out ğŸ˜ˆ\033[0m")

if __name__=="__main__":
    main()
